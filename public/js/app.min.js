function isset(e){return e!==void 0&&null!==e}function Ajax(e,t){this.post=[],this.elm=void 0,this.loader=void 0,e&&(this.elm=e,this.loader=document.createElement("span"),this.loader.className="loading",this.loader.innerHTML='<i class="n1"></i><i class="n2"></i><i class="n3"></i>',this.elm.parentNode.replaceChild(this.loader,this.elm)),this.post.push("action="+t),this.post.push("page="+page),this.addParam=function(e,t){this.post.push(e+"="+encodeURIComponent(t))},this.send=function(e,t){var a=this,o=new XMLHttpRequest;o.open("POST",ajax_url),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(this.post.join("&")),o.onreadystatechange=function(){if(o.readyState==o.DONE){if(200==o.status){console.log(o.responseText);var n=JSON.parse(o.responseText);"success"==n.status?e!==void 0&&e(n):t!==void 0&&t(n)}else 403==o.status?alert(m_error_login):alert(m_error_ajax);a.cancel()}}},this.cancel=function(){this.loader&&this.loader.parentNode.replaceChild(this.elm,this.loader)}}function season_watched(e){var t=e.target,a=t.dataset.s,o=new Ajax(void 0,"swatched");return o.addParam("snb",a),o.addParam("id",t.dataset.id),o.send(function(){document.location.reload()}),!1}function episode_watched(e){var t=e.target,a=t.parentNode.parentNode.parentNode.parentNode.parentNode,o=a.querySelector(".a-no"),n=a.querySelector(".span-no"),s=new Ajax(void 0,"watched");return s.addParam("id",o.dataset.id),s.addParam("no",o.textContent),s.send(function(){if(n.classList.contains("watched")){var e=a.querySelector(".span-date").textContent,t=new Date,o=t.getFullYear()+"-"+("0"+(t.getMonth()+1)).slice(-2)+"-"+("0"+t.getDate()).slice(-2);o>e&&""!==e&&n.classList.add("released"),n.classList.remove("watched")}else n.classList.remove("released"),n.classList.add("watched"),"home"==page&&a.parentNode.removeChild(a)}),!1}function open_popup(e){var t=e.target,a=t.parentNode,o=new Ajax(void 0,"subtitles");return o.addParam("id",t.dataset.id),o.addParam("no",t.textContent),o.send(function(e){a.querySelector(".div-subtitles").innerHTML=e.ans}),a.classList.add("open"),!1}function close_popup(e){var t=e.target;return t.parentNode.parentNode.parentNode.parentNode.parentNode.classList.remove("open"),!1}function more(e){var t=e.target;return t.parentNode.classList.add("more"),!1}isset(document.getElementById("logout"))&&(document.getElementById("logout").onclick=function(){return document.getElementById("form-logout").submit(),!1}),isset(document.getElementById("series"))&&(document.getElementById("series").onclick=function(){return document.getElementById("nav").className="display-series",!1}),isset(document.getElementById("back"))&&(document.getElementById("back").onclick=function(){return document.getElementById("nav").className="",!1});for(var a_season=document.querySelectorAll(".a-season"),i=a_season.length-1;i>=0;i--)a_season[i].onclick=season_watched;a_watched=document.querySelectorAll(".div-episode .a-watched");for(var i=a_watched.length-1;i>=0;i--)a_watched[i].onclick=episode_watched;for(var a_episode=document.querySelectorAll(".div-episode .a-no"),i=a_episode.length-1;i>=0;i--)a_episode[i].onclick=open_popup;for(var a_close=document.querySelectorAll(".a-close"),i=a_close.length-1;i>=0;i--)a_close[i].onclick=close_popup;for(var a_more=document.querySelectorAll(".a-more"),i=a_more.length-1;i>=0;i--)a_more[i].onclick=more;