function isset(e){return e!==void 0&&null!==e}function Ajax(e,t){this.post=[],this.elm=void 0,this.loader=void 0,e&&(this.elm=e,this.loader=document.createElement("span"),this.loader.className="loading",this.loader.innerHTML='<i class="n1"></i><i class="n2"></i><i class="n3"></i>',this.elm.parentNode.replaceChild(this.loader,this.elm)),this.post.push("action="+t),this.post.push("page="+page),this.addParam=function(e,t){this.post.push(e+"="+encodeURIComponent(t))},this.send=function(e,t){var n=this,o=new XMLHttpRequest;o.open("POST",ajax_url),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(this.post.join("&")),o.onreadystatechange=function(){if(o.readyState==o.DONE){if(200==o.status){var i=JSON.parse(o.responseText);"success"==i.status?e!==void 0&&e(i):t!==void 0&&t(i)}else 403==o.status?alert(m_error_login):alert(m_error_ajax);n.cancel()}}},this.cancel=function(){this.loader&&this.loader.parentNode.replaceChild(this.elm,this.loader)}}function onload_tags(){function e(){for(var e=a.querySelectorAll(".tag"),t=[],n=0;e.length>n;n++)t.push(e[n].innerHTML);s.value=t.join(",")}function t(t){return t.target.parentNode.removeChild(t.target),e(),!1}function n(e){var n=document.createElement("a");n.href="#",n.className="tag",n.innerHTML=e,l.appendChild(n),n.onclick=t}function o(){""!==r.value&&(n(r.value),r.value="",e())}function i(){if(""!==s.value)for(var e=s.value.split(/,/),t=0;e.length>t;t++)n(e[t])}var a=document.querySelector(".editTags"),l=a.querySelector("span"),s=document.getElementById("tags"),r=document.getElementById("addTag"),u=document.querySelector(".pick-tag"),c=u.querySelectorAll("span"),d=!1;u.onmousedown=function(e){"visible"==e.target.className&&(r.value=e.target.innerHTML,o(),d=!0)},r.onkeydown=function(e){if("keyCode"in e&&(13==e.keyCode||188==e.keyCode)||"key"in e&&("Enter"==e.key||","==e.key))return o(),r.blur(),r.focus(),!1;if("keyCode"in e&&9==e.keyCode||"key"in e&&"Tab"==e.key){var t=form.list.querySelector(".visible");return null!==t&&(r.value=t.innerHTML,o(),r.blur(),r.focus()),!1}},r.onfocus=function(){var e=r.getBoundingClientRect();u.style.left=e.left+"px",u.style.top=e.bottom+"px",r.onkeyup()},r.onblur=function(){d?(d=!1,setTimeout("document.getElementById('addTag').focus()",10)):(u.style.left="-9999px",u.style.top="-9999px")},r.onkeyup=function(){for(var e=r.value,t=0;c.length>t;t++)c[t].className=-1===c[t].innerHTML.indexOf(e)?"":"visible"},s.onupdate=i,i()}isset(document.getElementById("logout"))&&(document.getElementById("logout").onclick=function(){return document.getElementById("form-logout").submit(),!1}),isset(document.querySelector(".editTags"))&&onload_tags();